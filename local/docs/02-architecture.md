# ğŸ—ï¸ Arquitetura da CloudLab

VisÃ£o geral da infraestrutura local completa do projeto Nexo.

---

## ğŸ“ Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           macOS Host Machine                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        Docker Desktop                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  k3d Cluster (nexo-local)                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  k3d-server-0   â”‚  â”‚  k3d-agent-0    â”‚  â”‚  k3d-agent-1    â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  (Control Plane)â”‚  â”‚  (Worker Node)  â”‚  â”‚  (Worker Node)  â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                  NGINX Ingress Controller                   â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              (Port Mapping: 80:80, 443:443)                 â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                   Namespaces & Services                     â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                              â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ argocd         (GitOps)                                  â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ monitoring     (Prometheus + Grafana)                    â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ logging        (Elasticsearch + Kibana)                  â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ harbor-system  (Container Registry)                      â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ nexo-local     (Apps: nexo-be, nexo-fe, nexo-auth)      â”‚  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              External SSD: /Volumes/Backup/nexo-cloudlab               â”‚ â”‚
â”‚  â”‚         (Persistent Volumes for DBs, Elasticsearch, Harbor)            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  /etc/hosts mappings:                                                        â”‚
â”‚  127.0.0.1  *.nexo.local *.api.nexo.local *.auth.nexo.local                 â”‚
â”‚  127.0.0.1  argocd.nexo.local grafana.nexo.local harbor.nexo.local ...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Componentes Principais

### 1. Cluster Kubernetes (k3d)

```
k3d-nexo-local
â”œâ”€â”€ k3d-server-0  (Control Plane + etcd)
â”‚   â”œâ”€â”€ CPU: 2 cores
â”‚   â”œâ”€â”€ Memory: 4GB
â”‚   â””â”€â”€ Roles: control-plane, master
â”‚
â”œâ”€â”€ k3d-agent-0   (Worker Node)
â”‚   â”œâ”€â”€ CPU: 2 cores
â”‚   â”œâ”€â”€ Memory: 4GB
â”‚   â””â”€â”€ Roles: worker
â”‚
â””â”€â”€ k3d-agent-1   (Worker Node)
    â”œâ”€â”€ CPU: 2 cores
    â”œâ”€â”€ Memory: 4GB
    â””â”€â”€ Roles: worker

Volumes montados:
- /Volumes/Backup/nexo-cloudlab â†’ /mnt/data (em cada node)
```

### 2. GitOps Stack (ArgoCD)

```
Namespace: argocd

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ArgoCD Server                â”‚
â”‚  http://argocd.nexo.local              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Application Controller              â”‚
â”‚  â€¢ Repo Server                         â”‚
â”‚  â€¢ ApplicationSet Controller           â”‚
â”‚  â€¢ Notifications Controller            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â”€â”€ Git Repository (GitHub)
          â”‚    https://github.com/usuario/nexo
          â”‚    â”œâ”€â”€ apps/nexo-be/**
          â”‚    â”œâ”€â”€ apps/nexo-fe/**
          â”‚    â”œâ”€â”€ apps/nexo-auth/**
          â”‚    â””â”€â”€ local/helm/**
          â”‚
          â””â”€â”€â”€ Auto-sync com apps:
               â”œâ”€â”€ nexo-be-local
               â”œâ”€â”€ nexo-fe-local
               â””â”€â”€ nexo-auth-local
```

### 3. Observability Stack (Prometheus + Grafana)

```
Namespace: monitoring

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Prometheus Stack                       â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Prometheus   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  AlertManager   â”‚          â”‚
â”‚  â”‚   :9090        â”‚        â”‚     :9093       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                           â”‚                     â”‚
â”‚         â”‚                           â”‚                     â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
â”‚         â”‚                           â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚           Grafana                       â”‚             â”‚
â”‚  â”‚   http://grafana.nexo.local             â”‚             â”‚
â”‚  â”‚                                          â”‚             â”‚
â”‚  â”‚  Dashboards:                             â”‚             â”‚
â”‚  â”‚  â€¢ Kubernetes Cluster Monitoring         â”‚             â”‚
â”‚  â”‚  â€¢ Node Exporter Full                    â”‚             â”‚
â”‚  â”‚  â€¢ Pod Resource Usage                    â”‚             â”‚
â”‚  â”‚  â€¢ Persistent Volumes                    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Integrations:
â”œâ”€â”€ Node Exporter (mÃ©tricas de host)
â”œâ”€â”€ Kube State Metrics (mÃ©tricas de K8s)
â”œâ”€â”€ ServiceMonitors (custom app metrics)
â””â”€â”€ Alert Rules (notificaÃ§Ãµes via webhook)
```

### 4. Logging Stack (ELK)

```
Namespace: logging

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Elasticsearch Stack                      â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚         Elasticsearch Cluster              â”‚          â”‚
â”‚  â”‚              (3 nodes)                      â”‚          â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚          â”‚
â”‚  â”‚  â”‚ Data-0  â”‚  â”‚ Data-1  â”‚  â”‚ Data-2  â”‚   â”‚          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                      â”‚                                     â”‚
â”‚                      â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚            Kibana                         â”‚            â”‚
â”‚  â”‚   http://kibana.nexo.local                â”‚            â”‚
â”‚  â”‚                                            â”‚            â”‚
â”‚  â”‚  â€¢ Discover (busca de logs)               â”‚            â”‚
â”‚  â”‚  â€¢ Dashboards (visualizaÃ§Ãµes)             â”‚            â”‚
â”‚  â”‚  â€¢ Index Patterns (app-*, k8s-*)          â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                      â–²                                     â”‚
â”‚                      â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚        Filebeat (DaemonSet)              â”‚            â”‚
â”‚  â”‚  â€¢ Runs on every node                    â”‚            â”‚
â”‚  â”‚  â€¢ Collects container logs               â”‚            â”‚
â”‚  â”‚  â€¢ Sends to Elasticsearch                â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Container Registry (Harbor)

```
Namespace: harbor-system

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Harbor Registry                        â”‚
â”‚          http://harbor.nexo.local                         â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚              Harbor Core                    â”‚          â”‚
â”‚  â”‚  â€¢ Image storage & management               â”‚          â”‚
â”‚  â”‚  â€¢ User authentication (admin/Harbor12345)  â”‚          â”‚
â”‚  â”‚  â€¢ Project-based access control             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                      â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚           Harbor Components               â”‚            â”‚
â”‚  â”‚  â€¢ Registry:        Docker registry v2    â”‚            â”‚
â”‚  â”‚  â€¢ Portal:          Web UI                â”‚            â”‚
â”‚  â”‚  â€¢ JobService:      Async tasks           â”‚            â”‚
â”‚  â”‚  â€¢ Trivy:           Security scanning     â”‚            â”‚
â”‚  â”‚  â€¢ ChartMuseum:     Helm charts           â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                            â”‚
â”‚  Projects:                                                 â”‚
â”‚  â”œâ”€â”€ nexo/nexo-be                                         â”‚
â”‚  â”œâ”€â”€ nexo/nexo-fe                                         â”‚
â”‚  â””â”€â”€ nexo/nexo-auth                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. Application Stack (Nexo Apps)

```
Namespace: nexo-local

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Nexo Applications                     â”‚
â”‚                                                            â”‚
â”‚  Frontend (Next.js)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  nexo-fe                                    â”‚          â”‚
â”‚  â”‚  http://develop.nexo.local                  â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Replicas: 2                            â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Resources: 512Mi RAM, 500m CPU        â”‚          â”‚
â”‚  â”‚  â””â”€â”€ Env: NEXT_PUBLIC_API_URL,             â”‚          â”‚
â”‚  â”‚           NEXT_PUBLIC_AUTH_URL              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                      â”‚                                     â”‚
â”‚                      â”‚ HTTP requests                       â”‚
â”‚                      â–¼                                     â”‚
â”‚  Backend (NestJS)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  nexo-be                                    â”‚          â”‚
â”‚  â”‚  http://develop.api.nexo.local              â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Replicas: 2                            â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Resources: 1Gi RAM, 1000m CPU         â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Health: /health/live, /health/ready   â”‚          â”‚
â”‚  â”‚  â””â”€â”€ Dependencies:                          â”‚          â”‚
â”‚  â”‚      â”œâ”€â”€ PostgreSQL                         â”‚          â”‚
â”‚  â”‚      â”œâ”€â”€ Redis                              â”‚          â”‚
â”‚  â”‚      â””â”€â”€ Keycloak                           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                      â”‚                                     â”‚
â”‚                      â”‚ Authentication                      â”‚
â”‚                      â–¼                                     â”‚
â”‚  Auth Service (Keycloak)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  nexo-auth                                  â”‚          â”‚
â”‚  â”‚  http://develop.auth.nexo.local             â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Replicas: 1                            â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Resources: 1Gi RAM, 500m CPU          â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Realm: nexo                            â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Clients: nexo-fe, nexo-be             â”‚          â”‚
â”‚  â”‚  â””â”€â”€ Custom Themes: /themes/nexo           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                      â”‚                                     â”‚
â”‚  Databases                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  PostgreSQL 16                              â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Databases: nexo, nexo_auth, nexo_qa   â”‚          â”‚
â”‚  â”‚  â””â”€â”€ PVC: /Volumes/Backup/nexo-cloudlab    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Redis 7                                    â”‚          â”‚
â”‚  â”‚  â”œâ”€â”€ Cache & Sessions                       â”‚          â”‚
â”‚  â”‚  â””â”€â”€ AOF persistence                        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Deploy Flow (GitOps)

```
Developer â”€â”€â”
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Git Push          â”‚
â”‚   (develop branch)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          GitHub Actions Workflow                 â”‚
â”‚  1. Run tests (CI)                               â”‚
â”‚  2. Build Docker images                          â”‚
â”‚  3. Push to Harbor (harbor.nexo.local)           â”‚
â”‚  4. Update Helm values (Git commit)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ArgoCD Detects Changes              â”‚
â”‚  â€¢ Polls Git repository (every 3min)            â”‚
â”‚  â€¢ Compares desired state vs current state      â”‚
â”‚  â€¢ Auto-sync enabled                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ArgoCD Applies Changes                 â”‚
â”‚  1. Pull new Helm values from Git               â”‚
â”‚  2. Render templates                             â”‚
â”‚  3. Apply to Kubernetes                          â”‚
â”‚  4. Wait for health checks                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Kubernetes Rolling Update                   â”‚
â”‚  â€¢ Terminate old pods gracefully                 â”‚
â”‚  â€¢ Start new pods with new image                 â”‚
â”‚  â€¢ Health checks (liveness + readiness)          â”‚
â”‚  â€¢ Zero-downtime deployment                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Application Running                   â”‚
â”‚  â€¢ New version deployed                          â”‚
â”‚  â€¢ Metrics sent to Prometheus                    â”‚
â”‚  â€¢ Logs sent to Elasticsearch                    â”‚
â”‚  â€¢ ArgoCD status: Synced + Healthy              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Multi-Environment Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DNS Mapping                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  /etc/hosts configuration (auto-managed):               â”‚
â”‚                                                          â”‚
â”‚  127.0.0.1  develop.nexo.local                          â”‚
â”‚  127.0.0.1  develop.api.nexo.local                      â”‚
â”‚  127.0.0.1  develop.auth.nexo.local                     â”‚
â”‚                                                          â”‚
â”‚  127.0.0.1  qa.nexo.local                               â”‚
â”‚  127.0.0.1  qa.api.nexo.local                           â”‚
â”‚  127.0.0.1  qa.auth.nexo.local                          â”‚
â”‚                                                          â”‚
â”‚  127.0.0.1  staging.nexo.local                          â”‚
â”‚  127.0.0.1  staging.api.nexo.local                      â”‚
â”‚  127.0.0.1  staging.auth.nexo.local                     â”‚
â”‚                                                          â”‚
â”‚  127.0.0.1  prod.nexo.local                             â”‚
â”‚  127.0.0.1  prod.api.nexo.local                         â”‚
â”‚  127.0.0.1  prod.auth.nexo.local                        â”‚
â”‚                                                          â”‚
â”‚  # Tooling                                              â”‚
â”‚  127.0.0.1  argocd.nexo.local                           â”‚
â”‚  127.0.0.1  grafana.nexo.local                          â”‚
â”‚  127.0.0.1  prometheus.nexo.local                       â”‚
â”‚  127.0.0.1  alertmanager.nexo.local                     â”‚
â”‚  127.0.0.1  kibana.nexo.local                           â”‚
â”‚  127.0.0.1  harbor.nexo.local                           â”‚
â”‚  127.0.0.1  traefik.nexo.local                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            NGINX Ingress Controller                     â”‚
â”‚         (Host-based routing)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Ingress Rules:                                         â”‚
â”‚                                                          â”‚
â”‚  develop.* â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º nexo-local namespace              â”‚
â”‚  qa.*      â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º nexo-qa namespace                 â”‚
â”‚  staging.* â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º nexo-staging namespace            â”‚
â”‚  prod.*    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º nexo-prod namespace               â”‚
â”‚                                                          â”‚
â”‚  argocd.*       â”€â”€â”€â”€â”€â–º argocd namespace                 â”‚
â”‚  grafana.*      â”€â”€â”€â”€â”€â–º monitoring namespace             â”‚
â”‚  kibana.*       â”€â”€â”€â”€â”€â–º logging namespace                â”‚
â”‚  harbor.*       â”€â”€â”€â”€â”€â–º harbor-system namespace          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Resource Allocation

### Cluster Total Resources

```
Total Nodes:         3 (1 server + 2 agents)
Total CPU:           6 cores
Total Memory:        12 GB
Total Storage:       External SSD (/Volumes/Backup)
Network:             Docker bridge (localhost)
```

### Resource Distribution by Namespace

| Namespace     | CPU Request | CPU Limit | Memory Request | Memory Limit | Storage    |
| ------------- | ----------- | --------- | -------------- | ------------ | ---------- |
| argocd        | 500m        | 2000m     | 512Mi          | 2Gi          | 10Gi       |
| monitoring    | 1000m       | 3000m     | 2Gi            | 6Gi          | 50Gi       |
| logging       | 2000m       | 4000m     | 4Gi            | 8Gi          | 100Gi      |
| harbor-system | 1000m       | 2000m     | 2Gi            | 4Gi          | 50Gi       |
| nexo-local    | 2000m       | 4000m     | 3Gi            | 6Gi          | 20Gi       |
| **TOTAL**     | **6.5**     | **15**    | **11.5 Gi**    | **26 Gi**    | **230 Gi** |

---

## ğŸ”’ Security & Access Control

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Access Control                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Layer 1: Network (Docker)                              â”‚
â”‚  â”œâ”€â”€ Local network only (127.0.0.1)                     â”‚
â”‚  â”œâ”€â”€ No external exposure                               â”‚
â”‚  â””â”€â”€ Firewall: Docker internal bridge                   â”‚
â”‚                                                          â”‚
â”‚  Layer 2: Kubernetes RBAC                               â”‚
â”‚  â”œâ”€â”€ ServiceAccounts per app                            â”‚
â”‚  â”œâ”€â”€ Role/ClusterRole definitions                       â”‚
â”‚  â”œâ”€â”€ RoleBindings per namespace                         â”‚
â”‚  â””â”€â”€ ArgoCD: admin-level cluster access                 â”‚
â”‚                                                          â”‚
â”‚  Layer 3: Application                                   â”‚
â”‚  â”œâ”€â”€ Keycloak: OAuth2 + OIDC                            â”‚
â”‚  â”œâ”€â”€ JWT tokens (15min access, 7d refresh)              â”‚
â”‚  â”œâ”€â”€ Role-based permissions (admin, user, guest)        â”‚
â”‚  â””â”€â”€ Session management via Redis                       â”‚
â”‚                                                          â”‚
â”‚  Layer 4: Harbor Registry                               â”‚
â”‚  â”œâ”€â”€ Admin: admin/Harbor12345                           â”‚
â”‚  â”œâ”€â”€ Project-level access control                       â”‚
â”‚  â””â”€â”€ Vulnerability scanning (Trivy)                     â”‚
â”‚                                                          â”‚
â”‚  Layer 5: Database                                      â”‚
â”‚  â”œâ”€â”€ PostgreSQL: user/password auth                     â”‚
â”‚  â”œâ”€â”€ Network policies (only from nexo-be)               â”‚
â”‚  â””â”€â”€ Encrypted at rest (SSD encryption)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Monitoring & Observability

### Metrics Collection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Prometheus Metrics Flow                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚  nexo-be     â”‚ â”€â”€â”€ /metrics â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  (NestJS)    â”‚                  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                    â”‚
â”‚                                     â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚                    â”‚
â”‚  â”‚ Node Exporterâ”‚ â”€â”€â”€ :9100 â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚  â”‚ (DaemonSet)  â”‚                  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                    â”‚
â”‚                                     â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Kube State   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Prometheus  â”‚           â”‚
â”‚  â”‚ Metrics      â”‚           â”‚   (tsdb)     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                     â”‚                    â”‚
â”‚                                     â–¼                    â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚                              â”‚   Grafana    â”‚           â”‚
â”‚                              â”‚ (Dashboards) â”‚           â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Default Metrics Collected:
â€¢ Container CPU/Memory usage
â€¢ Pod restart count
â€¢ Request rate & latency
â€¢ Database connections
â€¢ Cache hit/miss ratio
â€¢ API endpoint performance
```

### Logging Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Logging Flow                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚  nexo-be     â”‚ â”€â”€â”€ stdout/stderr â”€â”€â”€â”               â”‚
â”‚  â”‚  (container) â”‚                       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚               â”‚
â”‚                                          â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚               â”‚
â”‚  â”‚  nexo-fe     â”‚ â”€â”€â”€ stdout/stderr â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚  (container) â”‚                       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚               â”‚
â”‚                                          â–¼               â”‚
â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                   â”‚   Filebeat   â”‚      â”‚
â”‚                                   â”‚ (DaemonSet)  â”‚      â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                          â”‚               â”‚
â”‚                                          â–¼               â”‚
â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                   â”‚Elasticsearch â”‚      â”‚
â”‚                                   â”‚  (3 nodes)   â”‚      â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                          â”‚               â”‚
â”‚                                          â–¼               â”‚
â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                   â”‚    Kibana    â”‚      â”‚
â”‚                                   â”‚  (Web UI)    â”‚      â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Log Structure:
{
  "@timestamp": "2025-06-10T10:30:00Z",
  "level": "info",
  "service": "nexo-be",
  "namespace": "nexo-local",
  "pod": "nexo-be-7d89f-xk2p9",
  "message": "Request processed",
  "context": {
    "method": "GET",
    "path": "/api/users",
    "duration": 45,
    "status": 200
  }
}
```

---

## ğŸ”§ Operations & Maintenance

### Daily Operations

```bash
# Ver status geral do cluster
make status

# Ver uso de recursos
make top

# Ver logs de uma aplicaÃ§Ã£o
make logs SERVICE=nexo-be NAMESPACE=nexo-local

# Acessar dashboards
make dashboard    # ArgoCD
make grafana      # Grafana
make kibana       # Kibana
```

### Regular Maintenance

```bash
# Limpar resources nÃ£o utilizados
docker system prune -af

# Backup do cluster
make backup

# Restart do cluster
make restart

# Troubleshooting completo
make troubleshoot
```

### Emergency Procedures

```bash
# Cluster nÃ£o responde
k3d cluster stop nexo-local
k3d cluster start nexo-local

# AplicaÃ§Ã£o crashando
kubectl delete pod -n nexo-local -l app=nexo-be

# Rollback de deploy
argocd app rollback nexo-be-local

# Restaurar do backup
make restore
```

---

## ğŸ“š ReferÃªncias

- [k3d Documentation](https://k3d.io/)
- [ArgoCD Documentation](https://argo-cd.readthedocs.io/)
- [Prometheus Operator](https://prometheus-operator.dev/)
- [Elastic Stack](https://www.elastic.co/guide/index.html)
- [Harbor Registry](https://goharbor.io/docs/)
- [Kubernetes Documentation](https://kubernetes.io/docs/)
